<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل الدخول | البرق ⚡</title>

    <!-- Google Font: Cairo -->
    <link href='https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap' rel='stylesheet'>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Architect's Professional Stylesheet -->
    <link rel="stylesheet" href="pro-style.css">

</head>
<body class="login-body antialiased">

    <div class="min-h-screen flex items-center justify-center p-4 relative z-10">
        <div class="theme-switcher" id="theme-switcher" style="position: absolute; top: 20px; left: 20px;">
            <i class="fas fa-sun"></i>
            <i class="fas fa-moon"></i>
        </div>
        <a href="index.html" style="position: absolute; top: 20px; right: 20px;" class="text-white font-bold hover:text-primary-color transition-colors">
            <i class="fas fa-home ml-1"></i> الرئيسية
        </a>

        <div class="glass-card p-8 sm:p-12 rounded-[30px] w-full max-w-md text-center">
            <div class="flex justify-center items-center gap-2 mb-6">
                <div class="w-12 h-12 bg-primary-color rounded-2xl flex items-center justify-center shadow-lg rotate-3">
                    <i class="fas fa-bolt text-white text-2xl"></i>
                </div>
                <span class="text-3xl font-black tracking-tighter italic">تسجيل الدخول</span>
            </div>
            
            <form class="space-y-4 text-right" onsubmit="handleLogin(event)">
                <div>
                    <label for="username" class="text-sm font-black mr-2 text-text-light-color">اسم المستخدم</label>
                    <input type="text" id="username" class="admin-input mt-1" required>
                </div>
                <div>
                    <label for="password" class="text-sm font-black mr-2 text-text-light-color">كلمة المرور</label>
                    <input type="password" id="password" class="admin-input mt-1" required>
                </div>
                <button type="submit" class="w-full bg-primary-color text-white py-4 rounded-2xl font-black text-lg shadow-lg hover:opacity-90 transition-all mt-4">دخـول</button>
                <p id="msg" class="text-center text-red-400 font-bold text-sm h-4"></p>
            </form>
        </div>
    </div>

    <!-- Global Logic -->
    <script src="pro-logic.js"></script>

    <!-- Page-specific Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            function ensureAdminExists() {
                let users = JSON.parse(localStorage.getItem('barq_users'));
                if (!users || !users.find(u => u.user.toLowerCase() === 'ayman')) {
                    users = [{ user: 'ayman', pass: '123456', role: 'admin' }, ...(users || [])];
                    localStorage.setItem('barq_users', JSON.stringify(users));
                    console.log("Default admin account has been created/verified.");
                }
            }
            ensureAdminExists();
        });

        function handleLogin(event) {
            event.preventDefault();
            
            const uInput = document.getElementById('username').value.trim();
            const pInput = document.getElementById('password').value.trim();
            const msg = document.getElementById('msg');

            const users = JSON.parse(localStorage.getItem('barq_users')) || [];
            const userFound = users.find(u => u.user.toLowerCase() === uInput.toLowerCase() && u.pass === pInput);

            if (userFound) {
                localStorage.setItem('activeSession', JSON.stringify(userFound));
                msg.style.color = "var(--success-color)";
                msg.innerText = "تم التحقق... جاري الدخول ⚡";
                
                setTimeout(() => {
                    window.location.href = 'admin.html'; 
                }, 500);
            } else {
                msg.innerText = "⚠️ البيانات غير صحيحة!";
                const card = document.querySelector(".glass-card");
                card.style.animation = 'shake 0.5s';
                setTimeout(() => card.style.animation = '', 500);
            }
        }
    </script>
</body>
</html>
